<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        button { padding: 15px; margin: 10px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç–æ–≤–æ–µ Mini App</h1>
    <button onclick="sendViaWebApp()">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ WebApp API</button>
    <button onclick="sendViaBotAPI()">ü§ñ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ Bot API</button>
    <div id="status">–°—Ç–∞—Ç—É—Å: –ì–æ—Ç–æ–≤–æ</div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        function updateStatus(message) {
            document.getElementById('status').textContent = '–°—Ç–∞—Ç—É—Å: ' + message;
        }

        function sendViaWebApp() {
            const data = {
                action: 'webapp_test',
                user_id: tg.initDataUnsafe.user?.id,
                timestamp: new Date().toISOString(),
                test_id: Math.random().toString(36).substr(2, 9)
            };
            
            try {
                tg.sendData(JSON.stringify(data));
                updateStatus('‚úÖ WebApp –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã');
            } catch (error) {
                updateStatus('‚ùå WebApp –æ—à–∏–±–∫–∞: ' + error);
            }
        }

        async function sendViaBotAPI() {
            const user = tg.initDataUnsafe.user;
            const data = {
                action: 'botapi_test',
                user_id: user?.id,
                first_name: user?.first_name,
                timestamp: new Date().toISOString(),
                test_id: Math.random().toString(36).substr(2, 9)
            };

            updateStatus('üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Bot API...');
            
            try {
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞–∫ –æ–±—ã—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É
                await fetch(`https://api.telegram.org/bot8263037925:AAHBNhfFys4FaoJ7NvOM4tSrhZQQ3UZNiz8/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: user?.id,
                        text: `üì¶ –î–∞–Ω–Ω—ã–µ Mini App: ${JSON.stringify(data)}`
                    })
                });
                
                updateStatus('‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ Bot API');
            } catch (error) {
                updateStatus('‚ùå –û—à–∏–±–∫–∞ Bot API: ' + error);
            }
        }

        // –î–µ–±–∞–≥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        console.log('Init Data:', tg.initData);
        console.log('User:', tg.initDataUnsafe.user);
    </script>
</body>
</html>
